# 设计模式之模板方法摸式

**模板方法模式属于行为设计模式**

它是在父类里定义算法的骨架，而让子类覆盖掉算法的一些特定步骤，但是不会改变算法的结构

![markdown](https://images.unsplash.com/photo-1568405336404-1fefdca58699?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=668&q=80 "
David Billings")

### 模板方法是如何工作的？
一般是需要将算法分解成一系列的步骤，再把这些步骤变成方法，然后在模板方法里调用这一系列的方法。这些方法可以是抽象的或者有默认实现。为了能够使用这个算法，可以写一个子类实现所有的抽象步骤或者覆盖一些其他的需要的(不是模板方法本身)方法

###模板方法的实现方式
1. 抽象的步骤必须要子类实现
2. 可选的步骤可以默认的实现，但是需要的情况仍然可以覆盖
> 其实还有一些其他的步骤--hook。hook是可选的步骤。通常会放在算法的关键步骤的前后，给子类提供一些算法的额外的扩展点。


###模板方法结构
1. Abstract Class
	声明一些方法作为算法的一系列步骤，以及模板方法--以特定的顺序调用这些方法。这些步骤要么是抽象的或者有默认的实现
2. Concrete Class
	覆盖所有的步骤，而不是模板方法本身

##什么时候使用模板方法模式？
- 当想让用户只继承某个算法的特定步骤，而不是整个算法或者结构的时候
> 会把整体的算法分解成一系列的独立步骤，以至于可以被子类继承，而父类的结构完整
- 当几个class具有完全一致的算法，但是只有小的不同的时候。但是一旦算法变化就需要修改两个class
> 将算法编程模板方法的时候，提取相似的实现到父类，移除重复的代码，不同的代码只存在于子类中

## 如何实现模板方法模式？
1. 分析目标算法能否分解成一系列步骤。考虑哪些步骤是通用的，哪些是不同的
2. 创建一个抽象的基类，声明模板方法和一系列的抽象方法代表算法的步骤。在模板方法里执行对应的步骤来绘制算法的结构。可以考虑修饰模板方法为final阻止子类覆盖
3. 所有的步骤可以是抽象的，但是可以 有一些默认的实现
4. 考虑算法的某些关键步骤，可以添加hooks
5. 对于算法的变种，可以创建一个新的子类，但是子类必须实现所有的抽象方法，可以覆盖可选的方法

##优点
1.  用户可以覆盖整个算法 的一部分，使得改变对算法的其他部分影响变小
2.  可以提取重复的代码到父类

##缺点
1. 子类会受到算法的骨架限制
2. 违背里世替换原则--限制子类的默认步骤替换
3. 当步骤越来越多的时候，模板方法越难维护

![eberhard grossgasteiger](https://images.unsplash.com/photo-1574270981993-f1df213562b3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80 "eberhard grossgasteiger")End

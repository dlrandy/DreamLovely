# 设计模式之策略模式

**策略模式属于行为模式**

行为设计模式是关于对象/class之间的交互方式。

![markdown](https://images.unsplash.com/photo-1569261995036-70d0dd50be24?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1789&q=80 "
Kevin Mueller")

### 什么是策略？
定义一组算法，每一个算法都放入一个独立的class，并使得它们的对象可以互换。

### 策略是如何工作的？
首先，策略模式需要四个组成部分：Context，Strategy，Concrete Strategies，Client。
1. 声明一个context维护着一个实体策略的引用，只用strategy接口与引用通信
2.  Strategy接口是所有实体策略通用的，声明一个context使用的方法执行策略
3. 实体策略集，实现了context使用算法的不同版本
4. 每次context运行算法的时候，context会调用相关策略的执行方法。context不知道策略类型以及策略的执行方式
5. client创建特定的策略并传给context。context暴露setter方法让client在运行时替换相关的策略


##具体思路
1. 在context 类里，识别出可能经常变化的算法。它很可能在大量的条件下，在运行时选择和执行同一个算法的不同变种
2. 声明一个策略接口，要求其对所有的算法变种通用
3. 一个接一个的将所有算法抽离到单独的class，但是它们应该实现策略接口
4. 在context类里，加一个域来存储策略对象的引用，并提供一个setter来替换策略对象的引用。context对象只能通过策略接口使用策略对象。context也可以定义接口让策略访问它的数据。
5. context的使用者，将context与适当的策略相联系



##什么时候需要使用策略模式？
1. 在一个对象里使用不同的算法的时候使用，同时能够在运行时从一个算法切换到另一个算法；
2. 当有很多相似的class，只在执行一些行为有些不同的时候
3. 用来隔离类的业务逻辑和算法的实现细节的，这个算法的细节可能和业务逻辑环境并不重要。
4. 当有大量的条件操作符时候，这些操作符在同一算法的不同变种之间切换

##优点
1. 可以在运行时，在对象里切换算法
2. 可以隔离算法的实现细节和算法的使用代码
3. 可以使用组合替代继承
4.  开闭原则，可以引入新的策略，不必改变context

##缺点
1. 如果只有几个算法，而且不经常改变，没有真正的原因遵循模式引来的新类和接口来过度复杂程序
2. client能够意识到策略之间的不同能够选择适当的策略
3. 许多现代语言有函数类型，可以支持实现不同版本算法在一组匿名的函数里，可以精确使用某个函数。

##和其他模式的关系
1. 桥接， 状态， 策略都有相似的结构。都是基于组合的，并将工作代理给其他的对象。但是解决的是不同的问题
2. 命令模式和策略也相似，因为都是用一些动作参数化一个对象。三十

![eberhard grossgasteiger](https://images.unsplash.com/photo-1569196769169-148d853ee706?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=564&q=80 "eberhard grossgasteiger")End
